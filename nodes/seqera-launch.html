<script type="text/html" data-template-name="seqera-launch">
  <div class="form-row">
    <label for="node-input-seqera"><i class="icon-globe"></i> Seqera config</label>
    <input type="text" id="node-input-seqera" data-type="seqera-config" />
  </div>
  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name" />
  </div>
</script>

<script type="text/html" data-help-name="seqera-launch">
  <p>Launches a new workflow execution via the Seqera Platform API.</p>
  <p>
      Provide a <b>Seqera config</b> for the API base URL, workspace ID, and token.
  </p>
  <p>
      <b>Quick start:</b> set <code>msg.launchpadName</code> to the name of a Launchpad entry (for example <code>nf-core-fetchngs</code>). The node will automatically look up the pipeline, retrieve its Launchpad configuration and submit the launch for you.
  </p>
  <p>
      <b>Advanced:</b> instead of <code>launchpadName</code> you may pass a fully-formed launch request object in <code>msg.payload</code> (or <code>msg.body</code>) together with optional overrides shown below.
      See the <a href="https://docs.seqera.io/api/reference/api-workflows-launch.html">API documentation</a> for details.
  </p>
  <p>
      <b>Additional overrides:</b> <em>(optional)</em> The following can be set via incoming <code>msg</code>:
      <ul>
          <li><code>msg.workspaceId</code> – Target workspace (numeric)</li>
          <li><code>msg.sourceWorkspaceId</code> – Source workspace (numeric)</li>
          <li><code>msg.baseUrl</code> – Base URL override</li>
          <li><code>msg.token</code> – API token override</li>
      </ul>
  </p>
  <h4>Outputs</h4>
  <ul>
      <li><code>msg.payload</code> – JSON response from the <code>/workflow/launch</code> endpoint.</li>
      <li><code>msg.workflowId</code> – Convenience copy of the newly launched workflow ID.</li>
  </ul>
  <p>
      On API error (4xx/5xx) the message still flows with:
      <ul>
          <li><code>msg._seqera_request</code> – request details (method, URL, headers, body).</li>
          <li><code>msg._seqera_error</code> – HTTP status and response payload (if any).</li>
      </ul>
  </p>
</script>

<script type="text/javascript">
  RED.nodes.registerType("seqera-launch", {
    category: "seqera",
    color: "#CBC6DD",
    inputs: 1,
    outputs: 1,
    icon: "rocket.svg",
    align: "right",
    paletteLabel: "Launch workflow",
    label: function () {
      return this.name || "Launch workflow";
    },
    defaults: {
      name: { value: "" },
      seqera: { value: "", type: "seqera-config" },
    },
  });
</script>
